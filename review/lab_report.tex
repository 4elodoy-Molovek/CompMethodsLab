\documentclass[a4paper,12pt]{article}

% --- Подключение пакетов ---
\usepackage[utf8]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[russian]{babel}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{geometry}
\usepackage{xcolor}
\usepackage{listings}      % Для кода
\usepackage[most]{tcolorbox} % Для красивых рамок
\usepackage{hyperref}      % Для ссылок
\usepackage{enumitem}      % Для списков
\usepackage{booktabs}      % Для таблиц
\usepackage{float}         % Для размещения рисунков
\usepackage{tikz}          % Для рисования схем
\usetikzlibrary{positioning, shapes, arrows.meta, calc, trees, decorations.pathreplacing, matrix}

% --- Настройка полей ---
\geometry{top=1.5cm, bottom=1.5cm, left=2cm, right=2cm}

% --- ОТКЛЮЧЕНИЕ НУМЕРАЦИИ ---
\setcounter{secnumdepth}{0}

% --- Настройка ссылок ---
\hypersetup{colorlinks=true, linkcolor=blue!60!black, urlcolor=blue!60!black}

% --- Цвета и стиль кода ---
\definecolor{codegreen}{rgb}{0,0.5,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codeblue}{rgb}{0.1,0.1,0.8}
\definecolor{backcolour}{rgb}{0.97,0.97,0.97}

% --- НАСТРОЙКА КИРИЛЛИЦЫ В КОДЕ ---
\lstset{
    inputencoding=utf8,
    extendedchars=true,
    literate={а}{{\selectfont\char224}}1
             {б}{{\selectfont\char225}}1
             {в}{{\selectfont\char226}}1
             {г}{{\selectfont\char227}}1
             {д}{{\selectfont\char228}}1
             {е}{{\selectfont\char229}}1
             {ё}{{\"e}}1
             {ж}{{\selectfont\char230}}1
             {з}{{\selectfont\char231}}1
             {и}{{\selectfont\char232}}1
             {й}{{\selectfont\char233}}1
             {к}{{\selectfont\char234}}1
             {л}{{\selectfont\char235}}1
             {м}{{\selectfont\char236}}1
             {н}{{\selectfont\char237}}1
             {о}{{\selectfont\char238}}1
             {п}{{\selectfont\char239}}1
             {р}{{\selectfont\char240}}1
             {с}{{\selectfont\char241}}1
             {т}{{\selectfont\char242}}1
             {у}{{\selectfont\char243}}1
             {ф}{{\selectfont\char244}}1
             {х}{{\selectfont\char245}}1
             {ц}{{\selectfont\char246}}1
             {ч}{{\selectfont\char247}}1
             {ш}{{\selectfont\char248}}1
             {щ}{{\selectfont\char249}}1
             {ъ}{{\selectfont\char250}}1
             {ы}{{\selectfont\char251}}1
             {ь}{{\selectfont\char252}}1
             {э}{{\selectfont\char253}}1
             {ю}{{\selectfont\char254}}1
             {я}{{\selectfont\char255}}1
             {А}{{\selectfont\char192}}1
             {Б}{{\selectfont\char193}}1
             {В}{{\selectfont\char194}}1
             {Г}{{\selectfont\char195}}1
             {Д}{{\selectfont\char196}}1
             {Е}{{\selectfont\char197}}1
             {Ё}{{\"E}}1
             {Ж}{{\selectfont\char198}}1
             {З}{{\selectfont\char199}}1
             {И}{{\selectfont\char200}}1
             {Й}{{\selectfont\char201}}1
             {К}{{\selectfont\char202}}1
             {Л}{{\selectfont\char203}}1
             {М}{{\selectfont\char204}}1
             {Н}{{\selectfont\char205}}1
             {О}{{\selectfont\char206}}1
             {П}{{\selectfont\char207}}1
             {Р}{{\selectfont\char208}}1
             {С}{{\selectfont\char209}}1
             {Т}{{\selectfont\char210}}1
             {У}{{\selectfont\char211}}1
             {Ф}{{\selectfont\char212}}1
             {Х}{{\selectfont\char213}}1
             {Ц}{{\selectfont\char214}}1
             {Ч}{{\selectfont\char215}}1
             {Ш}{{\selectfont\char216}}1
             {Щ}{{\selectfont\char217}}1
             {Ъ}{{\selectfont\char218}}1
             {Ы}{{\selectfont\char219}}1
             {Ь}{{\selectfont\char220}}1
             {Э}{{\selectfont\char221}}1
             {Ю}{{\selectfont\char222}}1
             {Я}{{\selectfont\char223}}1
}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen}\itshape,
    keywordstyle=\color{codeblue}\bfseries,
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codegray},
    basicstyle=\ttfamily\small,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    aboveskip=10pt,
    belowskip=10pt,
    language=Python,
    morekeywords={def, class, import, from, return, if, else, elif, for, while, try, except, True, False, None, lambda, self},
    mathescape=true
}

% --- Блоки ---
\newtcolorbox{definitionbox}[1]{colback=green!5!white, colframe=green!40!black, fonttitle=\bfseries, title=#1, sharp corners=downhill}
\newtcolorbox{lemmabox}[1]{colback=blue!5!white, colframe=blue!40!black, fonttitle=\bfseries, title=#1}
\newtcolorbox{theorembox}[1]{colback=red!5!white, colframe=red!40!black, fonttitle=\bfseries, title=#1}

\begin{document}

% --- Титульная страница ---
\begin{titlepage}
\centering

{\Large Национальный исследовательский Нижегородский государственный университет имени Н. И. Лобачевского}

\vspace{0.5cm}

(Институт информационных технологий, математики и механики)

\vspace{1cm}

{\large Кафедра: Алгебра, геометрия и дискретная математика (АГДМ)}

\vspace{2cm}

{\Large \textbf{Отчёт по лабораторной работе}}

\vspace{1cm}

{\large «Оптимизация последовательности переработки партий сахарной свёклы»}

\vspace{3cm}

\begin{flushright}
Выполнил:\\
Студент группы [номер группы]\\
[Фамилия Имя Отчество]

\vspace{1cm}

Научный руководитель:\\
[Фамилия Имя Отчество]
\end{flushright}

\vspace{2cm}

\centering
[Дата] г.

\end{titlepage}

\newpage

\tableofcontents
\newpage

\section{Постановка задачи}

\subsection{Математическая модель деградации свёклы}

Рассматривается задача оптимизации последовательности переработки $n$ партий сахарной свёклы на сахарном заводе. За единицу времени завод перерабатывает партию сырья массой $M$ одного сорта.

Пусть $i = \overline{1, n}$ — номер партии, $j = \overline{1, n}$ — этап переработки. Обозначим через $c_{ij}$ количество полезного ингредиента (сахара) в начале этапа $j$ для партии $i$.

Параметры $c_{ij}$ определяются через начальную долю полезного ингредиента $c_{i1} = a_i \in [a_{\min}, a_{\max}]$ и коэффициенты деградации $b_{i,j-1} = \frac{c_{ij}}{c_{i,j-1}}$ для $j = 2, \dots, n$. Соответствующие формулы имеют вид:

\begin{align}
c_{i1} &= a_i, \\
c_{ij} &= a_i b_{i1} \dots b_{i,j-1}, \quad i = 1, \dots, n, \quad j = 2, \dots, n.
\end{align}

\subsection{Процесс дозаривания свёклы}

Опционально учитывается процесс дозаривания (дозревания) свёклы:
\begin{itemize}
    \item Число этапов дозаривания ограничено и равно $v$, где $2 \leq v \leq \left\lfloor \frac{n}{2} \right\rfloor$.
    \item На этапах дозаривания параметры $b_{ij} \in (1, \beta_{\text{MAX}}]$ для $j = \overline{1, v - 1}$.
    \item На этапах увядания параметры $b_{ij} \in [\beta_1, \beta_2] \subset (0,1)$ для $j = \overline{v, n - 1}$.
    \item Рекомендуется брать $\beta_{\text{MAX}} = \frac{n - 1}{n - 2}$.
\end{itemize}

\subsection{Распределение коэффициентов}

Коэффициенты деградации $b_{ij}$ могут распределяться двумя способами:

\begin{enumerate}
    \item \textbf{Равномерное распределение:} $b_{ij}$ распределены равномерно на отрезке $[\beta_1, \beta_2]$ (для увядания) или $(1, \beta_{\text{MAX}}]$ (для дозаривания).
    
    \item \textbf{Концентрированное распределение:} Для каждой партии $i$ существует константа $\delta_i \leq \left| \frac{\beta_2 - \beta_1}{4} \right|$, такая что $b_{ij} \in [\beta_i^1, \beta_i^2] \subset [\beta_1, \beta_2]$, где $|\beta_i^1 - \beta_i^2| = \delta_i$. На этом подотрезке параметры распределены равномерно.
\end{enumerate}

\subsection{Матрица состояний и потери}

Имеется матрица состояний $\widetilde{S} = C - \widetilde{L}$, где:
\begin{itemize}
    \item $C$ — матрица коэффициентов содержания сахара для каждой партии (строки) на каждом этапе (столбцы).
    \item $\widetilde{L}$ — матрица с неотрицательными элементами потерь сахара.
    \item $\widetilde{S}$ — матрица коэффициентов содержания сахара после учёта потерь.
\end{itemize}

Элемент $l_{ij}$ матрицы потерь (в \%) вычисляется по формуле:
\begin{equation}
l_{ij} = 1.1 + 0.1541 \times (K_i + Na_i) + 0.2159 \times N_i + 0.9989 \times I_{ij} + 0.1967,
\end{equation}
где:
\begin{itemize}
    \item $K_i \in [4.8; 7.05]$ — содержание калия;
    \item $Na_i \in [0.21; 0.82]$ — содержание натрия;
    \item $N_i \in [1.58; 2.8]$ — содержание азота;
    \item $I_{ij} = I_{i0} \times (1.029)^{7j - 7}$, где $I_{i0} \in [0.62; 0.64]$ — начальный индекс, $j$ — номер этапа (нумерация с 1), 7 — количество дней в этапе.
\end{itemize}

Потери учитываются при расчёте итоговой матрицы: $\widetilde{S} = C - \frac{L}{100}$.

\subsection{Задача оптимизации}

Последовательность переработки сырья описывается перестановкой $\sigma$ натуральных чисел от 1 до $n$:

$$\sigma = \begin{pmatrix} 
1 & 2 & \dots & n-1 & n \\ 
\sigma(1) & \sigma(2) & \dots & \sigma(n-1) & \sigma(n) 
\end{pmatrix}$$

Общий выход сахара рассчитывается по формуле:
\begin{equation}
S(\sigma) = \widetilde{s}_{\sigma(1),1} + \widetilde{s}_{\sigma(2),2} + \dots + \widetilde{s}_{\sigma(n),n}
\end{equation}

Масса конечного продукта вычисляется как:
\begin{equation}
S = S(\sigma) \times M \times d,
\end{equation}
где $d = 7$ — число дней в этапе.

\textbf{Цель оптимизации:} найти такую перестановку $\sigma$ чисел от 1 до $n$ (последовательность переработки имеющихся партий сырья), при которой $S(\sigma)$ будет максимальным.

\subsection{Особенности задачи}

В начале этапа $j$ известны только первые $j$ столбцов матрицы, причём только для партий, ещё не переработанных. Это делает задачу нечёткой задачей о назначениях, что исключает применение точных алгоритмов (например, венгерского алгоритма) в реальном времени. Однако в рамках компьютерного эксперимента возможно сравнение различных эвристических стратегий с оптимальным решением, полученным венгерским алгоритмом.

\section{Как работает программа}

Разработанная система представляет собой веб-приложение на базе Electron с Python backend, предназначенное для моделирования и оптимизации процесса переработки сахарной свёклы.

\subsection{Архитектура системы}

Система состоит из трёх основных компонентов:

\begin{enumerate}
    \item \textbf{Frontend (Electron):} Графический интерфейс пользователя, реализованный на HTML/CSS/JavaScript с использованием Electron для создания десктопного приложения.
    
    \item \textbf{Backend (Flask):} REST API сервер на Python, обрабатывающий запросы на симуляцию и оптимизацию.
    
    \item \textbf{Модули обработки данных:} Генерация матриц состояний, расчёт потерь, применение алгоритмов оптимизации.
\end{enumerate}

\subsection{Процесс работы программы}

\subsubsection{Генерация данных}

При запуске симуляции система выполняет следующие шаги:

\begin{enumerate}
    \item \textbf{Генерация партий свёклы:} Для каждой партии $i = 1, \dots, n$ генерируются случайные параметры:
    \begin{itemize}
        \item Начальная сахаристость $a_i \in [a_{\min}, a_{\max}]$;
        \item Содержание калия $K_i \in [4.8; 7.05]$;
        \item Содержание натрия $Na_i \in [0.21; 0.82]$;
        \item Содержание азота $N_i \in [1.58; 2.8]$;
        \item Начальный индекс $I_{i0} \in [0.62; 0.64]$.
    \end{itemize}
    
    \item \textbf{Генерация коэффициентов деградации:} Формируется матрица $B$ размером $n \times n$, где элемент $B[i, j]$ — коэффициент перехода от этапа $j-1$ к этапу $j$ для партии $i$:
    \begin{itemize}
        \item Если включено дозаривание и $j \leq v-1$: $b_{ij} \in (1, \beta_{\text{MAX}}]$;
        \item Иначе (увядание): $b_{ij} \in [\beta_1, \beta_2] \subset (0,1)$;
        \item Распределение может быть равномерным или концентрированным.
    \end{itemize}
    
    \item \textbf{Расчёт матрицы состояний $C$:} Вычисляется матрица содержания сахара:
    \begin{align}
    C[i, 0] &= a_i, \\
    C[i, j] &= C[i, j-1] \times B[i, j], \quad j = 1, \dots, n-1.
    \end{align}
    
    \item \textbf{Расчёт матрицы потерь $L$:} Для каждого элемента вычисляется:
    \begin{equation}
    L[i, j] = 1.1 + 0.1541 \times (K_i + Na_i) + 0.2159 \times N_i + 0.9989 \times I_{ij} + 0.1967,
    \end{equation}
    где $I_{ij} = I_{i0} \times (1.029)^{7(j-1)}$.
    
    \item \textbf{Формирование итоговой матрицы $\widetilde{S}$:} Вычисляется матрица после учёта потерь:
    \begin{equation}
    \widetilde{S} = C - \frac{L}{100}.
    \end{equation}
\end{enumerate}

\subsubsection{Алгоритмы оптимизации}

Система реализует несколько стратегий оптимизации последовательности переработки:

\begin{enumerate}
    \item \textbf{Жадная стратегия (Greedy):} На каждом этапе $j$ выбирается доступная партия $i$ с максимальным значением $\widetilde{S}[i, j]$.
    
    \item \textbf{Бережливая стратегия (Thrifty):} На каждом этапе $j$ выбирается доступная партия $i$ с минимальным значением $\widetilde{S}[i, j]$.
    
    \item \textbf{Бережливая/Жадная (Thrifty/Greedy):} Первые $(n-\nu)$ этапов используют бережливую стратегию, затем с этапа $\nu$ применяется жадная стратегия. По умолчанию $\nu = \left\lfloor \frac{n}{2} \right\rfloor$.
    
    \item \textbf{Жадная/Бережливая (Greedy/Thrifty):} Первые $(n-\nu)$ этапов используют жадную стратегию, затем с этапа $\nu$ применяется бережливая стратегия.
    
    \item \textbf{Стратегия T(k)G:} Первые $(n-\nu)$ этапов выбирают $k$-ю позицию из отсортированного по возрастанию списка значений сахаристости, затем применяется жадная стратегия.
    
    \item \textbf{Стратегия Gk:} Вариация жадной стратегии с измерениями перед первым этапом и после этапов, кратных $k$. Выбираются $k$ партий с наивысшей сахаристостью и обрабатываются в порядке убывания.
    
    \item \textbf{Венгерский алгоритм:} Точный алгоритм решения задачи о назначениях, дающий оптимальное решение $S^*$ для сравнения с эвристиками.
\end{enumerate}

\subsubsection{Расчёт результатов}

Для каждой стратегии вычисляются:
\begin{itemize}
    \item Перестановка $\sigma$ — последовательность номеров партий;
    \item Выход сахара $S(\sigma) = \sum_{j=1}^{n} \widetilde{s}_{\sigma(j), j}$;
    \item Масса конечного продукта $S = S(\sigma) \times M \times 7$.
\end{itemize}

\subsubsection{Интерфейс пользователя}

Графический интерфейс позволяет:
\begin{itemize}
    \item Задавать параметры эксперимента (количество партий, диапазоны значений, тип распределения);
    \item Включать/выключать дозаривание и потери;
    \item Запускать симуляцию и просматривать результаты;
    \item Сравнивать эффективность различных стратегий;
    \item Визуализировать матрицы состояний и результаты оптимизации.
\end{itemize}

\subsubsection{Валидация входных данных}

Система выполняет проверку корректности входных параметров:
\begin{itemize}
    \item Проверка положительности $n$ и $M$;
    \item Проверка корректности диапазонов $[a_{\min}, a_{\max}]$ и $[\beta_1, \beta_2]$;
    \item Проверка условий для дозаривания: $2 \leq v \leq \left\lfloor \frac{n}{2} \right\rfloor$;
    \item Проверка типов распределения и других параметров.
\end{itemize}

\section{Заключение}

В рамках лабораторной работы была разработана система поддержки принятия решений для оптимизации последовательности переработки партий сахарной свёклы. Система позволяет моделировать процесс деградации свёклы с учётом дозаривания и потерь, сравнивать различные эвристические стратегии оптимизации и находить оптимальное решение с помощью венгерского алгоритма.

Реализованные алгоритмы демонстрируют различные подходы к решению задачи: от простых жадных стратегий до комбинированных методов, учитывающих особенности процесса переработки. Сравнение результатов различных стратегий позволяет выбрать наиболее эффективный подход для конкретных условий производства.

\section{Список литературы}

\begin{enumerate}
    \item Кнут Д. Э. Искусство программирования. Том 3. Сортировка и поиск / Д. Э. Кнут. — 2-е изд. — М.: Вильямс, 2000. — 832 с.
    
    \item Кормен Т., Лейзерсон Ч., Ривест Р., Штайн К. Алгоритмы: построение и анализ / Т. Кормен [и др.]. — 3-е изд. — М.: Вильямс, 2013. — 1328 с.
    
    \item Kuhn H. W. The Hungarian method for the assignment problem / H. W. Kuhn // Naval Research Logistics Quarterly. — 1955. — Vol. 2, No. 1-2. — P. 83-97.
    
    \item Munkres J. Algorithms for the Assignment and Transportation Problems / J. Munkres // Journal of the Society for Industrial and Applied Mathematics. — 1957. — Vol. 5, No. 1. — P. 32-38.
    
    \item SciPy Community. scipy.optimize.linear\_sum\_assignment — SciPy v1.11.0 Manual [Электронный ресурс]. — Режим доступа: \url{https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.linear_sum_assignment.html} (дата обращения: 2024).
    
    \item Flask Development Team. Flask — Web Development, One Drop at a Time [Электронный ресурс]. — Режим доступа: \url{https://flask.palletsprojects.com/} (дата обращения: 2024).
    
    \item Electron Contributors. Electron — Build cross-platform desktop apps with JavaScript, HTML, and CSS [Электронный ресурс]. — Режим доступа: \url{https://www.electronjs.org/} (дата обращения: 2024).
    
    \item NumPy Developers. NumPy — The fundamental package for scientific computing with Python [Электронный ресурс]. — Режим доступа: \url{https://numpy.org/} (дата обращения: 2024).
\end{enumerate}

\end{document}

